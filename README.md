This is the production code